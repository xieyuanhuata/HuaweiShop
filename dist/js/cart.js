"use strict";$(function(){function c(t){naranja().warn({title:"message",text:t,icon:!0,timeout:3e3})}var e=JSON.parse(localStorage.getItem("cartList"));function a(){var t=e.every(function(t){return!0===t.isSelected}),c='\n     <div class="cart-title clearfix">\n          <div class="checkbox fl">\n            <input type="checkbox" class="allcheck" '.concat(t?"checked":"",'>\n            全选\n          </div>\n          <ul class="clearfix fl">\n            <li>商品</li>\n            <li>单价</li>\n            <li>数量</li>\n            <li>小计</li>\n            <li>操作</li>\n          </ul>\n      </div>\n      ');e.forEach(function(t){c+='<div class="cart-item clearfix">\n        <div class="checkbox fl">\n         <input type="checkbox" data-id="'.concat(t.productId,'" ').concat(t.isSelected?"checked":"",' class="selectOne">\n        </div>\n         <div class="cart-area fl">\n            <div class="cart-pro-main clearfix">\n              <img src="https://res.vmallres.com/pimages/').concat(t.photoPath,"428_428_").concat(t.photoName,'" alt="">\n              <ul class="fl">\n                <li>').concat(t.skuName,"</li>\n                <li>¥ ").concat(void 0===t.promoPrice?t.price:t.promoPrice,'</li>\n                <li>\n                  <div class="shopNum">\n                    <div class="shopNum-area">\n                      <input type="text" value="').concat(t.number,'" readonly>\n                      <div class="shopNum-btn">\n                        <a href="javascipt:void(0)" class="fl sub" data-id=').concat(t.productId,'  >-</a>\n                        <a href="javascipt:void(0)" class="fr add" data-id=').concat(t.productId,'>+</a>\n                      </div>\n                    </div>\n                  </div>\n                </li>\n                <li class="shop-total">¥ ').concat(t.total,'</li>\n                <li>\n                  <a href="javascript:void(0)" class="del-shop" data-id=').concat(t.productId,">删 除</a>\n                </li>\n              </ul>\n            </div>\n         </div>\n      </div>")});var i=e.filter(function(t){return t.isSelected}),a=0,n=0;i.forEach(function(t){a+=t.number,n+=t.total}),c+='<div class="cart-account clearfix"> \n        <button class="clearAll">清空购物车</button>\n        <div class="right-btn">\n          <a href="javascript:void(0)" class="'.concat(i.length?"":"disabled",'">立即结算</a>\n        </div>\n        <div class="totle-price">\n          <p><em>总计: </em><span>¥ ').concat(n.toFixed(2),'</span></p>\n          <div class="totle-choose">\n            共 <em>').concat(a,"</em> 件商品, 优惠: <span>¥ 0.00</span>\n          </div>\n        </div>\n       </div> \n    \n    "),$(".cartList").html(c)}e?(a(),$(".cartList").on("change",".allcheck",function(){var c=this;e.forEach(function(t){t.isSelected=c.checked}),a(),localStorage.setItem("cartList",JSON.stringify(e))}),$(".cartList").on("change",".selectOne",function(){var c=$(this).data("id");e.forEach(function(t){t.productId===c&&(t.isSelected=!t.isSelected)}),a(),localStorage.setItem("cartList",JSON.stringify(e))}),$(".cartList").on("click",".sub",function(){var c=$(this).data("id");e.forEach(function(t){t.productId===c&&(1<t.number&&t.number--,t.total=t.number*(void 0===t.promoPrice?t.price:t.promoPrice))}),a(),localStorage.setItem("cartList",JSON.stringify(e))}),$(".cartList").on("click",".add",function(){var c=$(this).data("id");e.forEach(function(t){t.productId===c&&(t.number++,t.total=t.number*(void 0===t.promoPrice?t.price:t.promoPrice))}),a(),localStorage.setItem("cartList",JSON.stringify(e))}),$(".cartList").on("click",".del-shop",function(){var i=$(this).data("id");e.forEach(function(t,c){t.productId===i&&e.splice(c,1)}),a(),localStorage.setItem("cartList",JSON.stringify(e)),0===e.length&&($(".cart-title").css("display","none"),$(".cart-account").css("display","none"),c("您的购物车是空的,快去选购吧"),setTimeout(function(){window.location.href="../pages/list.html"},3e3))}),$(".cartList").on("click",".clearAll",function(){var t=confirm("确定清空购物车?");t&&e.splice(0,e.length),a(),localStorage.setItem("cartList",JSON.stringify(e)),$(".cart-title").css("display","none"),$(".cart-account").css("display","none"),c("您的购物车是空的,快去选购吧"),setTimeout(function(){window.location.href="../pages/list.html"},3e3)})):(c("您的购物车是空的,快去选购吧"),setTimeout(function(){window.location.href="../pages/list.html"},3e3))});